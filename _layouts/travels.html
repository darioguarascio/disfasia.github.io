<!DOCTYPE html>
<html lang="en">
  {% include head.html %}

<style type="text/css">
.affix {
  top:16px;
}
.self .img-wrapper {
    background-color: black;
}
.self img {
    opacity: 0.4;
}
.self.active img {
    opacity: 1;
}

#travelssb > div {
    width: 100%;
}
#travelssb ul.travelssb > li {
  display: none;
}
#travelssb ul li img.place {
  width: 288px;
  float:left;
}
#travelssb ul li.active {
  display: block;
}
#travelssb ul.flickr-side {
    padding: 0;
    width: 170px;
    float:left;
    height: 191px;
    overflow: hidden;
}
#travelssb ul.flickr-side li {
    display: block;
    float: left;
    margin: 0 0 10px 10px;
}
#travelmap {
    height: 150px;
    margin-bottom: 10px;
}
#travelmap .gmnoprint {
    display: none !important;
}
</style>
  <body class="travels" data-spy="scroll" data-target="#travelssb">
    {% include header.html %}
    <div class="container">
        {{ content }}
    </div>
    {% include scripts.html %}


    <script src="http://maps.googleapis.com/maps/api/js?sensor=false"></script>
    
    <script>

//$(document).ready(function(){
        
        var myLatLng = new google.maps.LatLng( 50, 50 ),
            myOptions = {
                streetViewControl: false,
                zoomControl: false,
                scaleControl: false,
                mapTypeControl: false,
                zoom: 4,
                center: myLatLng,
                mapTypeId: google.maps.MapTypeId.ROADMAP
                },
            map = new google.maps.Map( $('#travelmap')[0], myOptions ),
            marker = new google.maps.Marker( {position: myLatLng, map: map} );
        
        marker.setMap( map );        

    $('#travelssb > div').width($('#travelssb > div').width());
    $('#travelssb ul li').on('activate.bs.scrollspy', function (e) {
        //document.location.hash = 
        console.log(this);
        var $li = $(this), $flickrSide = $('.flickr-side', $li);

        var coords = $li.data('coords').split(','), $rel = $li.attr('rel');

        $('.self').removeClass('active');
        $('#'+ $rel).addClass('active');

        if (coords.length == 2){ 
            var newpos = new google.maps.LatLng( coords[0], coords[1] )
            marker.setPosition(  newpos );
            map.panTo( newpos );
        }

        if (!$flickrSide.data('loaded')) {
            $.getJSON("http://api.flickr.com/services/rest/?",
                {
                    method: "flickr.photosets.getPhotos",
                    api_key: "6a611031a41f71e0a475e9eec463fbad",
                    photoset_id: $flickrSide.attr('rel'),
                    format: "json", nojsoncallback: "1",
                    per_page: 6
                },
                function(data) {console.log(data);
                    var cnt = 0;
                    for (item in data.photoset.photo) {
                        cnt++;
                        item = data.photoset.photo[item];
                        var photoURL = 'http://farm' + item.farm + '.static.flickr.com/' + item.server + '/' + item.id + '_' + item.secret + '_s.jpg'
                        $flickrSide.append(
                            $('<li></li>').append(
                                $('<img/>', { 
                                   src: photoURL, 
                                   alt:'MyAlt'
                                })
                            )
                        )
                    }
                    $flickrSide.data('loaded', 1);
            });  
        }
     });
//});
    </script>

  </body>
</html>
